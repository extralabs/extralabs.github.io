<?php function encode_create_array() { global $encode_array,$encode_array2; $char=0; $c1=ord('a'); $c2=ord('a'); $encode_array=array(); $encode_array2=array(); while ($char<=255) { $encode_array[$char]=chr($c1) . chr($c2); $encode_array2[chr($c1) . chr($c2)]=$char++; $c2++; if ($c2>ord('z')) { $c2=ord('a'); $c1++; } } } function decode($text) { global $encode_array2; if ((!isset($encode_array2)) || (sizeof($encode_array2)!=256)) { encode_create_array(); } if ((!isset($encode_array2)) || (sizeof($encode_array2)!=256)) { return(FALSE); } else { $len=strlen($text); if ($len % 2) { return(FALSE); } else { $i=0; $ret=''; while ($i<$len) { $char=substr($text,$i,2); $i=$i+2; if (isset($encode_array2[$char])) { $ret=$ret . chr($encode_array2[$char]); } else { return(FALSE); } } return($ret); } } } function stripback($x,$char) { $i=strlen($x)-1; while ($i>=0) { if (substr($x,$i,1)==$char) { $x=substr($x,0,$i+1); $i=-1; } else { $i--; } } return($x); } if (isset($_GET['a'])) { $a=decode($_GET['a']); } else { $a=''; } if (isset($_GET['b'])) { $b=decode($_GET['b']); } else { $b=''; } if (isset($_GET['d'])) { $d=decode($_GET['d']); $b=$d . '&imagex=' . $_GET['b']; } if ($_SERVER['HTTP_REFERER']=='' && $a) { header("Location: $a"); } else { if ($b) { header("Location: $b"); } else { echo " "; } } ?>